<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prem - Creative Developer Portfolio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-tilt/1.7.2/vanilla-tilt.min.js"></script>
    <style>
        :root {
            --cursor-color: #4f46e5; /* indigo-600 */
            --cursor-color-dark: #818cf8; /* indigo-400 */
        }
        html.dark {
             --cursor-color: var(--cursor-color-dark);
        }

        body {
            font-family: 'Poppins', sans-serif;
            transition: background-color 0.3s, color 0.3s;
            cursor: none;
        }

        /* Custom Cursor */
        .cursor-dot {
            width: 8px;
            height: 8px;
            background-color: var(--cursor-color);
            position: fixed;
            border-radius: 50%;
            pointer-events: none;
            transform: translate(-50%, -50%);
            transition: width 0.2s, height 0.2s;
            z-index: 9999;
        }
        .cursor-outline {
            width: 40px;
            height: 40px;
            border: 2px solid var(--cursor-color);
            position: fixed;
            border-radius: 50%;
            pointer-events: none;
            transform: translate(-50%, -50%);
            transition: all 0.1s ease-out;
            z-index: 9999;
        }
        body:hover .cursor-dot, body:hover .cursor-outline {
            opacity: 1;
        }

        /* Hero Canvas */
        #hero-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        .hero-content {
            position: relative;
            z-index: 2;
        }

        /* Project Card Tilt Effect */
        .project-card {
            transform-style: preserve-3d;
            transform: perspective(1000px);
        }

        /* Section Animation */
        .section {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }
        .section.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Glassmorphism Header */
        .glassmorphism {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .dark .glassmorphism {
             background: rgba(17, 24, 39, 0.2);
             border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Enhanced Button */
        .btn-primary {
            background-image: linear-gradient(to right, #4f46e5 0%, #ec4899 51%, #4f46e5 100%);
            background-size: 200% auto;
            transition: background-position 0.5s;
        }
        .btn-primary:hover {
            background-position: right center;
        }
        
        /* Scroll to top button with progress */
        #to-top-button svg.progress-ring__circle {
            transition: stroke-dashoffset 0.3s;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-200">

    <div class="cursor-dot"></div>
    <div class="cursor-outline"></div>

    <!-- Header -->
    <header class="fixed top-0 left-0 right-0 z-50 glassmorphism">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#" class="text-2xl font-bold text-indigo-600 dark:text-indigo-400">PM</a>
            <div class="hidden md:flex space-x-8 items-center">
                <a href="#about" class="hover:text-indigo-500 dark:hover:text-indigo-300 transition">About</a>
                <a href="#skills" class="hover:text-indigo-500 dark:hover:text-indigo-300 transition">Skills</a>
                <a href="#projects" class="hover:text-indigo-500 dark:hover:text-indigo-300 transition">Projects</a>
                <a href="#contact" class="hover:text-indigo-500 dark:hover:text-indigo-300 transition">Contact</a>
            </div>
            <div class="flex items-center">
                 <button id="theme-toggle" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition">
                    <i data-feather="moon" class="dark-icon hidden"></i>
                    <i data-feather="sun" class="light-icon"></i>
                </button>
                <button class="md:hidden ml-4" id="mobile-menu-button">
                    <i data-feather="menu"></i>
                </button>
            </div>
        </nav>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-white dark:bg-gray-800">
            <a href="#about" class="block py-2 px-6 hover:bg-gray-100 dark:hover:bg-gray-700">About</a>
            <a href="#skills" class="block py-2 px-6 hover:bg-gray-100 dark:hover:bg-gray-700">Skills</a>
            <a href="#projects" class="block py-2 px-6 hover:bg-gray-100 dark:hover:bg-gray-700">Projects</a>
            <a href="#contact" class="block py-2 px-6 hover:bg-gray-100 dark:hover:bg-gray-700">Contact</a>
        </div>
    </header>

    <!-- Hero Section -->
    <section id="hero" class="min-h-screen flex items-center justify-center relative overflow-hidden bg-gray-50 dark:bg-gray-900">
        <canvas id="hero-canvas"></canvas>
        <div class="hero-content container mx-auto px-6 text-center">
            <div class="max-w-4xl mx-auto">
                <h1 class="text-4xl md:text-7xl font-bold mb-4 leading-tight">
                    Hi, I'm Premkumar Marimuthu.
                    <span class="block bg-clip-text text-transparent bg-gradient-to-r from-indigo-500 via-pink-500 to-orange-400">A Creative Developer.</span>
                </h1>
                <p class="text-lg md:text-xl text-gray-600 dark:text-gray-300 mb-8">I build beautiful, responsive, and user-friendly web applications.</p>
                <a href="#projects" class="btn-primary text-white font-semibold px-8 py-4 rounded-full transition transform hover:scale-105 inline-block">View My Work</a>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="py-24 section">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-16">About Me</h2>
            <div class="flex flex-col md:flex-row items-center gap-16">
                <div class="md:w-1/3">
                    <img src="recent-photo-1.jpg" alt="Prem" class="rounded-full shadow-2xl mx-auto transform hover:scale-105 transition-transform duration-500">
                </div>
                <div class="md:w-2/3 text-center md:text-left">
                    <h3 class="text-2xl font-semibold mb-4">Crafting Digital Experiences</h3>
                    <p class="text-lg mb-4 text-gray-600 dark:text-gray-400">Hello! I'm Prem, a developer with a passion for creating elegant solutions. I thrive on turning complex problems into simple, beautiful, and intuitive designs. I have a strong background in both front-end and back-end technologies.</p>
                    <p class="text-lg text-gray-600 dark:text-gray-400">My journey in web development is a continuous cycle of learning and creating. I'm always excited to explore new technologies to build better and faster applications. When not coding, I enjoy contributing to open-source and exploring the great outdoors.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Skills Section -->
    <section id="skills" class="py-24 bg-gray-100 dark:bg-gray-800 section">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-16">Technologies I Use</h2>
            <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-8 text-center">
                <!-- Skill Item -->
                <div class="flex flex-col items-center justify-center p-4 bg-white dark:bg-gray-700 rounded-lg shadow-md hover:shadow-xl transform hover:-translate-y-2 transition-all duration-300">
                    <i data-feather="figma" class="w-12 h-12 text-pink-500 mb-3"></i>
                    <h3 class="font-semibold">Figma</h3>
                </div>
                <div class="flex flex-col items-center justify-center p-4 bg-white dark:bg-gray-700 rounded-lg shadow-md hover:shadow-xl transform hover:-translate-y-2 transition-all duration-300">
                    <i data-feather="code" class="w-12 h-12 text-blue-500 mb-3"></i>
                    <h3 class="font-semibold">React</h3>
                </div>
                <div class="flex flex-col items-center justify-center p-4 bg-white dark:bg-gray-700 rounded-lg shadow-md hover:shadow-xl transform hover:-translate-y-2 transition-all duration-300">
                    <svg class="w-12 h-12 mb-3 text-green-500" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Node.js</title><path d="M11.998 24a12.002 12.002 0 01-4.408-23.21l.488.872A11.001 11.001 0 0012 22.999a11.001 11.001 0 009.43-5.553l.87.49a12.001 12.001 0 01-10.302 6.064zM12 1a11.002 11.002 0 00-9.43 5.553l-.87-.49A12.001 12.001 0 0112 0a12.002 12.002 0 014.408 23.21l-.488-.872A11.001 11.001 0 0012 1.001zm6.845 3.403L12.23 18.913a.25.25 0 01-.44 0L5.155 4.403a.25.25 0 01.22-.353h13.25a.25.25 0 01.22.353zm-1.12 1H6.275l6.09 13.628L17.725 5.403z"/></svg>
                    <h3 class="font-semibold">Node.js</h3>
                </div>
                <div class="flex flex-col items-center justify-center p-4 bg-white dark:bg-gray-700 rounded-lg shadow-md hover:shadow-xl transform hover:-translate-y-2 transition-all duration-300">
                    <i data-feather="database" class="w-12 h-12 text-indigo-500 mb-3"></i>
                    <h3 class="font-semibold">PostgreSQL</h3>
                </div>
                <div class="flex flex-col items-center justify-center p-4 bg-white dark:bg-gray-700 rounded-lg shadow-md hover:shadow-xl transform hover:-translate-y-2 transition-all duration-300">
                    <i data-feather="box" class="w-12 h-12 text-cyan-500 mb-3"></i>
                    <h3 class="font-semibold">Docker</h3>
                </div>
                <div class="flex flex-col items-center justify-center p-4 bg-white dark:bg-gray-700 rounded-lg shadow-md hover:shadow-xl transform hover:-translate-y-2 transition-all duration-300">
                    <i data-feather="git-branch" class="w-12 h-12 text-red-500 mb-3"></i>
                    <h3 class="font-semibold">Git</h3>
                </div>
            </div>
        </div>
    </section>

    <!-- Projects Section -->
    <section id="projects" class="py-24 section">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-16">Featured Projects</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
                <!-- Project Card 1 -->
                <div class="project-card bg-gray-700 rounded-lg shadow-xl overflow-hidden group" data-tilt>
                    <img src="https://placehold.co/600x400/334155/FFFFFF?text=Project+One" alt="Project 1" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-100 group-hover:opacity-100 transition-opacity duration-300">
                        <div class="p-6 absolute bottom-0 left-0 right-0 text-white transform translate-y-8 group-hover:translate-y-0 transition-transform duration-500">
                            <h3 class="text-2xl font-bold mb-1">E-commerce Platform</h3>
                            <p class="text-gray-300 mb-4 text-sm">MERN Stack, Redux, Stripe</p>
                            <a href="#" class="font-semibold text-indigo-400 hover:text-white">View Details &rarr;</a>
                        </div>
                    </div>
                </div>
                <!-- Project Card 2 -->
                <div class="project-card bg-gray-700 rounded-lg shadow-xl overflow-hidden group" data-tilt>
                    <img src="https://placehold.co/600x400/1e293b/FFFFFF?text=Project+Two" alt="Project 2" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                     <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-100 group-hover:opacity-100 transition-opacity duration-300">
                        <div class="p-6 absolute bottom-0 left-0 right-0 text-white transform translate-y-8 group-hover:translate-y-0 transition-transform duration-500">
                            <h3 class="text-2xl font-bold mb-1">Task Management App</h3>
                            <p class="text-gray-300 mb-4 text-sm">Next.js, Firebase, dnd-kit</p>
                            <a href="#" class="font-semibold text-indigo-400 hover:text-white">View Details &rarr;</a>
                        </div>
                    </div>
                </div>
                <!-- Project Card 3 -->
                <div class="project-card bg-gray-700 rounded-lg shadow-xl overflow-hidden group" data-tilt>
                    <img src="https://placehold.co/600x400/475569/FFFFFF?text=Project+Three" alt="Project 3" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                     <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-100 group-hover:opacity-100 transition-opacity duration-300">
                        <div class="p-6 absolute bottom-0 left-0 right-0 text-white transform translate-y-8 group-hover:translate-y-0 transition-transform duration-500">
                            <h3 class="text-2xl font-bold mb-1">Data Visualization Dashboard</h3>
                            <p class="text-gray-300 mb-4 text-sm">React, D3.js, Python/Flask</p>
                            <a href="#" class="font-semibold text-indigo-400 hover:text-white">View Details &rarr;</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="py-24 bg-gray-100 dark:bg-gray-800 section">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-4">Let's Build Something Amazing</h2>
            <p class="text-center text-lg text-gray-600 dark:text-gray-400 mb-12 max-w-2xl mx-auto">Have a project in mind or just want to say hi? My inbox is always open.</p>
            <div class="max-w-2xl mx-auto">
                <form id="contact-form" class="bg-white dark:bg-gray-700 p-8 rounded-lg shadow-lg">
                    <div id="form-feedback" class="mb-4 text-center h-6"></div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <input type="text" id="name" name="name" placeholder="Your Name" required class="w-full p-3 rounded-md bg-gray-100 dark:bg-gray-600 border-2 border-transparent focus:border-indigo-500 focus:ring-0 transition">
                        <input type="email" id="email" name="email" placeholder="Your Email" required class="w-full p-3 rounded-md bg-gray-100 dark:bg-gray-600 border-2 border-transparent focus:border-indigo-500 focus:ring-0 transition">
                    </div>
                    <div class="mb-6">
                        <textarea id="message" name="message" rows="5" placeholder="Your Message" required class="w-full p-3 rounded-md bg-gray-100 dark:bg-gray-600 border-2 border-transparent focus:border-indigo-500 focus:ring-0 transition"></textarea>
                    </div>
                    <div class="text-center">
                        <button type="submit" class="btn-primary text-white font-semibold px-8 py-4 rounded-full transition transform hover:scale-105">Send Message</button>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-800 dark:bg-black text-white py-12">
        <div class="container mx-auto px-6 text-center">
            <div class="flex justify-center space-x-6 mb-6">
                <a href="#" class="hover:text-indigo-400 transition"><i data-feather="github"></i></a>
                <a href="#" class="hover:text-indigo-400 transition"><i data-feather="linkedin"></i></a>
                <a href="#" class="hover:text-indigo-400 transition"><i data-feather="twitter"></i></a>
            </div>
            <p class="text-gray-400">&copy; 2025 Prem. Crafted with ❤️.</p>
        </div>
    </footer>
    
    <!-- Scroll to top button -->
    <button id="to-top-button" class="hidden fixed bottom-5 right-5 w-14 h-14 rounded-full text-white hover:bg-indigo-700/20 transition transform hover:scale-110 shadow-lg z-50">
        <svg class="w-full h-full" viewBox="0 0 36 36">
            <circle class="progress-ring__circle" stroke="url(#gradient)" stroke-width="3" fill="transparent" r="16" cx="18" cy="18"/>
            <defs>
                <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                    <stop offset="0%" style="stop-color:#4f46e5;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#ec4899;stop-opacity:1" />
                </linearGradient>
            </defs>
        </svg>
        <div class="absolute inset-0 flex items-center justify-center">
            <i data-feather="arrow-up" class="text-indigo-500"></i>
        </div>
    </button>

    <script>
        // --- INITIALIZATION ---
        feather.replace();
        VanillaTilt.init(document.querySelectorAll(".project-card"), {
            max: 15,
            speed: 400,
            glare: true,
            "max-glare": 0.5,
        });

        // --- CUSTOM CURSOR ---
        const cursorDot = document.querySelector('.cursor-dot');
        const cursorOutline = document.querySelector('.cursor-outline');
        window.addEventListener('mousemove', e => {
            const posX = e.clientX;
            const posY = e.clientY;
            cursorDot.style.left = `${posX}px`;
            cursorDot.style.top = `${posY}px`;
            cursorOutline.style.left = `${posX}px`;
            cursorOutline.style.top = `${posY}px`;
        });
        document.querySelectorAll('a, button, [data-tilt]').forEach(el => {
            el.addEventListener('mouseenter', () => {
                cursorDot.style.width = '20px';
                cursorDot.style.height = '20px';
                cursorOutline.style.width = '60px';
                cursorOutline.style.height = '60px';
            });
            el.addEventListener('mouseleave', () => {
                cursorDot.style.width = '8px';
                cursorDot.style.height = '8px';
                cursorOutline.style.width = '40px';
                cursorOutline.style.height = '40px';
            });
        });

        // --- MOBILE MENU ---
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        mobileMenuButton.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });
        document.querySelectorAll('#mobile-menu a').forEach(link => {
            link.addEventListener('click', () => mobileMenu.classList.add('hidden'));
        });

        // --- THEME TOGGLE ---
        const themeToggle = document.getElementById('theme-toggle');
        const darkIcon = document.querySelector('.dark-icon');
        const lightIcon = document.querySelector('.light-icon');
        let isDarkMode = false;

        const applyTheme = (theme) => {
            isDarkMode = theme === 'dark';
            document.documentElement.classList.toggle('dark', isDarkMode);
            darkIcon.classList.toggle('hidden', !isDarkMode);
            lightIcon.classList.toggle('hidden', isDarkMode);
            if (window.neuronAnimation) {
                window.neuronAnimation.updateTheme(isDarkMode);
            }
        };
        const savedTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
        applyTheme(savedTheme);
        themeToggle.addEventListener('click', () => {
            const newTheme = document.documentElement.classList.contains('dark') ? 'light' : 'dark';
            localStorage.setItem('theme', newTheme);
            applyTheme(newTheme);
        });

        // --- SCROLL ANIMATIONS ---
        const sections = document.querySelectorAll('.section');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                    observer.unobserve(entry.target);
                }
            });
        }, { threshold: 0.1 });
        sections.forEach(section => observer.observe(section));

        // --- CONTACT FORM ---
        const contactForm = document.getElementById('contact-form');
        const formFeedback = document.getElementById('form-feedback');
        contactForm.addEventListener('submit', function(e) {
            e.preventDefault();
            formFeedback.textContent = 'Sending...';
            formFeedback.className = 'mb-4 text-center text-blue-500';
            setTimeout(() => {
                formFeedback.textContent = 'Message sent successfully! Thank you.';
                formFeedback.className = 'mb-4 text-center text-green-500';
                contactForm.reset();
                setTimeout(() => formFeedback.textContent = '', 5000);
            }, 2000);
        });
        
        // --- SCROLL TO TOP BUTTON & PROGRESS ---
        const toTopButton = document.getElementById('to-top-button');
        const progressCircle = document.querySelector("#to-top-button .progress-ring__circle");
        const radius = progressCircle.r.baseVal.value;
        const circumference = radius * 2 * Math.PI;
        progressCircle.style.strokeDasharray = `${circumference} ${circumference}`;
        progressCircle.style.strokeDashoffset = circumference;

        function setProgress(percent) {
            const offset = circumference - percent / 100 * circumference;
            progressCircle.style.strokeDashoffset = offset;
        }

        window.addEventListener('scroll', () => {
            const scrollTop = window.pageYOffset;
            const docHeight = document.documentElement.scrollHeight - window.innerHeight;
            const scrollPercent = (scrollTop / docHeight) * 100;
            
            if (scrollTop > 300) {
                toTopButton.classList.remove('hidden');
            } else {
                toTopButton.classList.add('hidden');
            }
            setProgress(scrollPercent);
        });

        toTopButton.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // --- THREE.JS BRAIN NEURON ANIMATION ---
        class NeuronAnimation {
            constructor(canvas, isDark) {
                this.canvas = canvas;
                this.isDark = isDark;
                this.mouse = new THREE.Vector2(-100, -100);
                this.init();
            }

            init() {
                this.scene = new THREE.Scene();
                this.camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                this.camera.position.z = 12;

                this.renderer = new THREE.WebGLRenderer({ canvas: this.canvas, alpha: true });
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

                this.createNetwork();
                
                document.addEventListener('mousemove', this.onMouseMove.bind(this), false);
                window.addEventListener('resize', this.onResize.bind(this), false);

                this.animate();
            }

            updateTheme(isDark) {
                this.isDark = isDark;
                const pointColor = this.isDark ? 0x818cf8 : 0x4f46e5; // indigo-400 : indigo-600
                const lineColor = this.isDark ? 0x374151 : 0xd1d5db; // gray-700 : gray-300
                this.points.material.color.setHex(pointColor);
                this.lines.material.color.setHex(lineColor);
            }

            createNetwork() {
                const numPoints = 200;
                const maxDist = 4;
                this.points_data = [];
                const positions = [];

                // Create points (neurons)
                for (let i = 0; i < numPoints; i++) {
                    const x = (Math.random() - 0.5) * 25;
                    const y = (Math.random() - 0.5) * 25;
                    const z = (Math.random() - 0.5) * 25;
                    positions.push(x, y, z);
                    this.points_data.push({
                        position: new THREE.Vector3(x, y, z),
                        velocity: new THREE.Vector3(),
                        acceleration: new THREE.Vector3()
                    });
                }

                const pointGeometry = new THREE.BufferGeometry();
                pointGeometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));
                const pointMaterial = new THREE.PointsMaterial({ size: 0.1, blending: THREE.AdditiveBlending, transparent: true });
                this.points = new THREE.Points(pointGeometry, pointMaterial);
                this.scene.add(this.points);

                // Create lines (synapses)
                const lineIndices = [];
                for (let i = 0; i < numPoints; i++) {
                    for (let j = i + 1; j < numPoints; j++) {
                        const dist = this.points_data[i].position.distanceTo(this.points_data[j].position);
                        if (dist < maxDist) {
                            lineIndices.push(i, j);
                        }
                    }
                }
                const lineGeometry = new THREE.BufferGeometry();
                lineGeometry.setAttribute('position', this.points.geometry.attributes.position);
                lineGeometry.setIndex(lineIndices);
                const lineMaterial = new THREE.LineBasicMaterial({ blending: THREE.AdditiveBlending, transparent: true, opacity: 0.2 });
                this.lines = new THREE.LineSegments(lineGeometry, lineMaterial);
                this.scene.add(this.lines);

                // Create pulsing synapses
                this.pulseMaterial = new THREE.LineBasicMaterial({ transparent: true, opacity: 0, linewidth: 2 });
                this.pulseGeometry = new THREE.BufferGeometry();
                this.pulseGeometry.setAttribute('position', new THREE.Float32BufferAttribute([], 3));
                this.pulses = new THREE.LineSegments(this.pulseGeometry, this.pulseMaterial);
                this.scene.add(this.pulses);
                this.activePulses = [];

                this.updateTheme(this.isDark);
            }

            onMouseMove(event) {
                this.mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
                this.mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
            }

            onResize() {
                this.camera.aspect = window.innerWidth / window.innerHeight;
                this.camera.updateProjectionMatrix();
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            }
            
            triggerPulse(startIndex) {
                const startPoint = this.points_data[startIndex].position;
                const neighbors = [];
                const linePositions = this.lines.geometry.index.array;
                const pointPositions = this.points.geometry.attributes.position.array;

                for(let i = 0; i < linePositions.length; i+=2) {
                    if (linePositions[i] === startIndex) neighbors.push(linePositions[i+1]);
                    if (linePositions[i+1] === startIndex) neighbors.push(linePositions[i]);
                }
                
                if (neighbors.length > 0) {
                    const neighborIndex = neighbors[Math.floor(Math.random() * neighbors.length)];
                    const endPoint = this.points_data[neighborIndex].position;
                    this.activePulses.push({
                        start: startPoint,
                        end: endPoint,
                        progress: 0,
                        lifespan: 1
                    });
                }
            }

            animate() {
                requestAnimationFrame(this.animate.bind(this));

                // Mouse interaction
                const raycaster = new THREE.Raycaster();
                raycaster.setFromCamera(this.mouse, this.camera);
                raycaster.params.Points.threshold = 0.5;
                const intersects = raycaster.intersectObject(this.points);

                if (intersects.length > 0) {
                    if (Math.random() > 0.95) { // Throttle pulse creation
                        this.triggerPulse(intersects[0].index);
                    }
                }

                // Animate pulses
                const pulsePositions = [];
                const pulseColors = this.isDark ? [new THREE.Color(0xec4899), new THREE.Color(0xf97316)] : [new THREE.Color(0xdb2777), new THREE.Color(0xea580c)]; // pink/orange
                
                this.activePulses.forEach((p, i) => {
                    p.progress += 0.02;
                    if (p.progress >= 1) {
                        this.activePulses.splice(i, 1);
                        return;
                    }
                    const currentPos = new THREE.Vector3().lerpVectors(p.start, p.end, p.progress);
                    const nextPos = new THREE.Vector3().lerpVectors(p.start, p.end, p.progress + 0.05);
                    pulsePositions.push(currentPos.x, currentPos.y, currentPos.z);
                    pulsePositions.push(nextPos.x, nextPos.y, nextPos.z);
                });

                this.pulseGeometry.setAttribute('position', new THREE.Float32BufferAttribute(pulsePositions, 3));
                this.pulseMaterial.color.lerpColors(pulseColors[0], pulseColors[1], Math.sin(Date.now() * 0.005));
                this.pulseMaterial.opacity = Math.max(0, 1 - this.activePulses.length / 10); // Fade if too many pulses

                // Animate points
                const positions = this.points.geometry.attributes.position.array;
                for (let i = 0; i < this.points_data.length; i++) {
                    const p = this.points_data[i];
                    const jiggle = new THREE.Vector3(
                        (Math.random() - 0.5) * 0.001,
                        (Math.random() - 0.5) * 0.001,
                        (Math.random() - 0.5) * 0.001
                    );
                    p.position.add(jiggle);
                    positions[i * 3] = p.position.x;
                    positions[i * 3 + 1] = p.position.y;
                    positions[i * 3 + 2] = p.position.z;
                }
                this.points.geometry.attributes.position.needsUpdate = true;
                this.lines.geometry.attributes.position.needsUpdate = true;

                this.scene.rotation.y += 0.0002;
                this.renderer.render(this.scene, this.camera);
            }
        }

        window.neuronAnimation = new NeuronAnimation(
            document.getElementById('hero-canvas'),
            document.documentElement.classList.contains('dark')
        );

    </script>
</body>
</html>
